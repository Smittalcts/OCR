<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>On-Call Review Agent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Base styles from original index.html */
        .message p { margin: 0; }
        .bot-message { align-self: flex-start; background-color: #e5e7eb; color: #1f2937; }
        .user-message { align-self: flex-end; background-color: #3b82f6; color: white; }
        .status-message { align-self: center; background-color: #f3f4f6; color: #6b7280; font-style: italic; font-size: 0.875rem; padding: 4px 10px !important; }
        .evaluation-message { align-self: flex-start; background-color: #dbeafe; border-left: 4px solid #60a5fa; }
        .topic-summary-message { align-self: flex-start; background-color: #e0f2fe; border-left: 4px solid #38bdf8; }
        .final-score-message { align-self: center; background-color: #d1fae5; color: #065f46; border: 1px solid #6ee7b7; font-weight: bold; }
        .error-message { align-self: center; background-color: #fee2e2; color: #b91c1c; }
        #chat-box::-webkit-scrollbar { width: 6px; }
        #chat-box::-webkit-scrollbar-track { background: #f1f5f9; }
        #chat-box::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        #chat-box::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .typing-indicator { display: flex; align-items: center; padding: 12px; }
        .typing-indicator span { height: 8px; width: 8px; border-radius: 50%; background-color: #94a3b8; margin: 0 2px; animation: bounce 1.4s infinite ease-in-out both; }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }

        /* Styles for new Transcript Modal */
        #transcript-content::-webkit-scrollbar { width: 6px; }
        #transcript-content::-webkit-scrollbar-track { background: #f1f5f9; }
        #transcript-content::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    </style>
</head>
<body class="h-full flex items-center justify-center font-sans bg-gradient-to-br from-gray-50 to-gray-200">
    
    <div id="dashboard-container" class="w-full max-w-4xl h-[95vh] bg-white rounded-2xl shadow-2xl flex flex-col p-4 md:p-6">
        <div class="header flex justify-between items-center pb-4 border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-800">AI On-Call Review Dashboard</h2>
            <div>
                <span id="user-greeting" class="text-gray-600 mr-4"></span>
                <button id="logout-btn" class="px-4 py-2 bg-red-500 text-white text-sm font-semibold rounded-lg shadow-md hover:bg-red-600 transition">Logout</button>
            </div>
        </div>
        <div id="dashboard-content" class="flex-1 p-4 overflow-y-auto bg-gray-50 rounded-lg my-4">
            <!-- Content loaded by JS -->
        </div>
    </div>

    <div id="interview-container" class="w-full max-w-2xl h-[90vh] bg-white rounded-2xl shadow-2xl flex flex-col p-4 md:p-6 hidden">
        <div class="header text-center pb-4 border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-800">AI On-Call Review</h2>
        </div>
        <div id="chat-box" class="chat-box flex-1 p-4 overflow-y-auto flex flex-col gap-4 my-4 bg-gray-50 rounded-lg" style="scroll-behavior: smooth;">
            <!-- Chat messages loaded by JS -->
        </div>
        <div class="input-container flex gap-3">
            <input type="text" id="user-input" placeholder="Type your answer..." class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none transition disabled:bg-gray-200" disabled>
            <button id="send-btn" class="px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transition disabled:bg-blue-300 disabled:cursor-not-allowed" disabled>Send</button>
        </div>
        <div class="footer text-center pt-4 mt-4 border-t border-gray-200">
            <button id="end-btn" class="w-full md:w-auto px-8 py-3 bg-red-500 text-white font-bold rounded-lg shadow-lg hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-75 transition">End & Get Final Score</button>
        </div>
    </div>

    <div id="results-container" class="hidden w-full max-w-3xl bg-white rounded-2xl shadow-2xl flex-col p-6 md:p-8">
        <div class="text-center pb-4 border-b border-gray-200">
            <h2 class="text-3xl font-bold text-gray-800">Interview Results</h2>
        </div>
        <div id="final-summary-card" class="my-6 p-6 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl text-center shadow-lg">
            <!-- Final score loaded by JS -->
        </div>
        <div id="topic-results-container" class="space-y-4">
            <!-- Topic scores loaded by JS -->
        </div>
        <div class="text-center pt-6 mt-6 border-t border-gray-200">
             <button id="back-to-dashboard-btn" class="w-full md:w-auto px-8 py-3 bg-blue-500 text-white font-bold rounded-lg shadow-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transition">Back to Dashboard</button>
        </div>
    </div>

    <!-- NEW: Transcript Modal -->
    <div id="transcript-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center hidden z-50">
        <div class="relative p-6 md:p-8 bg-white w-full max-w-3xl h-[85vh] rounded-2xl shadow-xl flex flex-col">
            <div id="transcript-modal-close" class="flex justify-between items-center pb-4 border-b">
                <h3 class="text-2xl font-bold text-gray-800">Interview Transcript</h3>
                <button class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
            </div>
            <div id="transcript-content" class="overflow-y-auto flex-1 mt-4 pr-2">
                <!-- Transcript content loaded by JS -->
            </div>
        </div>
    </div>



<script type="module" src="/static/js/app.js"></script>

</body>
</html>

